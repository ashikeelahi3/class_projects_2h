---
title: "Distribution And Order Statistics"
author: "Ashik E Elahi"
date: "2024-02-17"
output: html_document
---

##### Problem: 1 - Suppose X follows a normal distribution with mean $\mu$ and variance $\sigma^2$.
##### (i) Plot the distributions on a graph paper separately with ($\mu = 3, \sigma^2 = 16), (\mu = 5, \sigma^2 = 16)$, and ($\mu = 4, \sigma^2 = 16$) and compare the graphs.

##### (ii) Plot the distributions on same graph paper with ($\mu = 4, \sigma^2 = 4), (\mu = 4, \sigma^2 = 9)$, and ($\mu = 4, \sigma^2 = 16)$


##### Solution 1 (i):

```{r}
set.seed(21)
par(mfrow = c(1, 3))
mu <- c(3, 5, 7)
sigma.2 <- c(16, 16, 16)
sigma <- sqrt(sigma.2)
colors <- c("red", "green", "blue")
labels <- paste0("N(", mu, ",", sigma, ")")
x <- seq(-20, 20, 0.01)

for(i in 1:length(mu)) {
  fx <- dnorm(x, mean = mu[i], sd = sigma[i])
  plot(x, fx, type="l", col = colors[i], lwd=3,
      main = labels[i], xlab = "x ->", 
      ylab = "Frequency f(x)")
  
  segments(x0 = mu[i], y0 = 0, x1 = mu[i], y1 = max(fx), lwd = 2, lty=3)
}
```

##### Solution 1 (ii):

```{r}
set.seed(2112)
mu <- c(4, 4, 4)
sigma.2 <- c(4, 9, 16)
sigma <- sqrt(sigma.2)
colors <- c("red", "green", "blue")
labels <- paste0("N(", mu, ",", sigma, ")")
x <- seq(-20, 20, 0.01)

for(i in 1:length(mu)) {
  fx <- dnorm(x, mean = mu[i], sd = sigma[i])
  if(i == 1) {
    plot(x, fx, type="l", col = colors[i], lwd=3,
        main = labels[i], xlab = "x ->", 
        ylab = "Frequency f(x)")
  } else {
    lines(x, fx, lwd=3, col=colors[i])
  }
}
abline(v=mu[1], lty=3) 

```

##### Problem 2: Generate 1200 random samples of size n = 12 with $\mu = 4$ and $\sigma^2 = 9$. Suppose $s^2=\frac{1}{n-1}\sum_i^n (x_i - \bar{x})^2$. Using sitable graph, justify that $\frac{(n-1)s^2}{\sigma^2}$ follows a chi-square distribution with (n-1) degress of freedom.

##### **Method - 1:**

```{r}
set.seed(221)
par(mfrow=c(1, 1))
n = 12
mu = 4
sigma = sqrt(9)
it = 1200

xvar = array()
for(i in 1:it) {
  x = rnorm(n, mu, sigma)
  xvar[i] = var(x)  
}
# xvar -> list of variances

x = ((n-1)*xvar)/sigma^2
hist(x, breaks = 15, freq = F, col = "gray", xlab = expression(((n-1)*s^2)/sigma^2), main="Chi-square distribution")

x.2 = seq(0,120, 0.01)
chisq.pdf = dchisq(x.2, df=n-1)
lines(x.2, chisq.pdf, col="blue", lwd=3)
```

##### **Method - 2:**
```{r}
set.seed(11)
#Generate 1200 random sample of size 12
n = 12
mu = 2
sigma = sqrt(9)

samples <- replicate(1200, rnorm(n, mean = mu, sd = sigma))
# samples

# apply(samples, 2, var)

#Calculate the test statistic for each sample
test_statistic <- (n-1)*(apply(samples, 2, var)/sigma^2)


hist(test_statistic, breaks = 25, probability= TRUE,
     main = "Distribution of Test Statistic",
     xlab="Test Statistic",
     ylab="Density")

# Plot the chi-square distribution with (n-1) degrees of freedom 
x <- seq(0, max(test_statistic)+5, length.out = 100)
lines(x, dchisq(x, df=n-1), col="red", lwd=2, lty=6)

#dchisq(x, df=n-1)
```

##### Problem 3: A random sample of size 4 is drawn from a population that has a uniform distribution on the interval (0, 5). The resulting order statistics are $X_{1:4}, X_{2:4}, X_{3:4}$ and $X_{4:4}$. Determine the cumulative distribution function (CDF) of the $3^{rd}$ order statistics $(X_{3:4})$ and plot the CDF of the $3^{rd}$ order statistic. Evaluate the probability $P[X_{3:4} >= 2]$


###### Method - 1:

```{r}
cdf_uniform <- function(x, a, b) {
  ifelse(x < 0, 0, ifelse(x > 5, 1, (x-a)/(b-a)))
}

Fr_n_eqn <- function(x, r, n) {
  sum_eqn <- ""
  for(j in r:n) {
    term <- paste0("(", n, "C", j, ")", "F(x)^", j, "[1-F(x)]^(",n, "-", j, ")")
    if(j < n) {
      sum_eqn = paste0(sum_eqn, term, "+")
    } else {
      sum_eqn = paste0(sum_eqn, term)
    }
  }
  return(sum_eqn)
}

Fr_n_value <- function(x, r, n, a, b) {
  cdf_x = cdf_uniform(x, a, b)
  sum_value = 0
  
  for(j in r:n) {
    sum_value = sum_value + choose(n, j)*(cdf_x^j)*(1-cdf_x)^(n-j)
  }
  return(sum_value)
}


# Results

r <- 3
n <- 4
a <- 0
b <- 5
x <- seq(a, b, length.out=100)

Fr_n_equation <- Fr_n_eqn(x, r, n)
Fr_n_values <- Fr_n_value(x, r, n, a, b)



cat("The distribution function F", r, ":", n, "(x) is given by :\n", Fr_n_equation)

plot(x, Fr_n_values, type="l", xlab = "x->", ylab = paste0("F", r, ":", n, "(x)"))

# P(x_3:4 > 2)
x_threshold <- 2
p_x3_gt_x <- 1 - Fr_n_value(x_threshold, r, n, a, b)
p_x3_gt_x
```

##### Problem 4: Suppose $X_{1:7} < X_{2:7} < X_{3:7} < X_{4:7} < X_{5:7} < X_{6:7} < X_{7:7}$ denote the order statistics based on a random sample of size 7 from the distribution having probability density function (pdf) $f(x) = \frac{1}{10}, 0 \leq x \leq 10$. Evaluate the mean and variance of the $5^{th}$ order statistic $(X_{5:7})$ and plot the CDF of the $5^{th}$ order statistic.


```{r}
cdf_dis = function(x, a, b) {
  ifelse(x < a, 0, ifelse(x > b, 1, x / 10))
}

# cdf
fr_n = function(x, a, b) {
  cdf_x = cdf_dis(x, a, b)
  pdf_x = 0.1
  
  numerator <- factorial(n) / (factorial(r-1)*factorial(n-r))
    prob_dist <- numerator * cdf_x^(r-1) * (1 - cdf_x)^(n-r)*pdf_x
    prob_dist
}

a = 0
b = 10
r = 5
n = 7
```